SELECT CASE WHEN RTrim(xmlagg(xmlelement(e,tablespace_name, ' | ').extract('//text()')),';') || Chr(10)|| RTrim(xmlagg(xmlelement(e,Trunc(used_percent,1),'        |    ').extract('//text()')),';')  <> chr(10) THEN RTrim(xmlagg(xmlelement(e,tablespace_name, ' | ').extract('//text()')),';') || Chr(10)|| RTrim(xmlagg(xmlelement(e,Trunc(used_percent,1),'        |    ').extract('//text()')),';') ELSE 'none' END tablespaces FROM DBA_TABLESPACE_USAGE_METRICS WHERE Trunc(used_percent) >= 80;